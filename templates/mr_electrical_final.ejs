<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <style>
        body {
            font-family: Arial, sans-serif;
            font-size: 11px;
            color: #000;
            margin: 0;
            padding: 20px;
        }
        .invoice-box {
            max-width: 800px;
            margin: auto;
            border: 1px solid #000;
        }
        .header-top {
            text-align: right;
            padding: 5px;
            font-size: 10px;
        }
        .company-header {
            text-align: center;
            border-bottom: 1px solid #000;
            padding-bottom: 5px;
        }
        .company-name {
            font-size: 20px;
            font-weight: bold;
            margin: 0;
        }
        .company-details {
            margin: 3px 0;
            font-size: 10px;
        }
        .tax-invoice-title {
            text-align: center;
            font-weight: bold;
            border-top: 1px solid #000;
            border-bottom: 1px solid #000;
            padding: 3px 0;
            background-color: #f9f9f9;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            table-layout: fixed;
        }
        th, td {
            border: 1px solid #000;
            padding: 3px;
            vertical-align: top;
            word-wrap: break-word;
        }
        .no-border-top { border-top: none; }
        .no-border-bottom { border-bottom: none; }
        .no-border-left { border-left: none; }
        .no-border-right { border-right: none; }

        .client-section {
            width: 50%;
        }
        .meta-section {
            width: 50%;
        }
        .items-table th {
            text-align: center;
            font-size: 10px;
        }
        .items-table td {
            height: 20px;
        }
        .text-right { text-align: right; }
        .text-center { text-align: center; }
        .bold { font-weight: bold; }

        .hsn-table th { font-size: 9px; }
        .hsn-table td { font-size: 9px; }

        .footer-section {
            display: flex;
            border-top: 1px solid #000;
        }
        .bank-details {
            width: 60%;
            padding: 5px;
            border-right: 1px solid #000;
        }
        .signatory-section {
            width: 40%;
            text-align: right;
            padding: 5px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
        .terms {
            font-size: 8px;
            padding: 5px;
        }
    </style>
</head>
<body>
    <div class="invoice-box">
        <div class="header-top">Original Buyer/Seller/Transporter</div>
        
        <div class="company-header">
            <h1 class="company-name">M.R. ELECTRICALS</h1>
            <div class="company-details">
                91/1 Dr. G.S Bose Road Kolkata -700039<br>
                Phone No.-9831149296/9163659580.<br>
                GSTIN:19CIIPS8859M1ZZ. STATE CODE :WB19
            </div>
        </div>

        <div class="tax-invoice-title">TAX INVOICE</div>

        <table>
            <tr>
                <td class="client-section no-border-left" rowspan="4">
                    Customer<br>
                    <span class="bold"><%= client_name %></span><br>
                    <%- client_address %><br>
                    PH : <br>
                    (M): <br>
                    PAN: <br>
                    GSTIN/UIN:<%= client_gstin %><br>
                    STATE NAME:<%= client_state %><br>
                    Place of Supply:<%= client_state.split(' ')[1] || client_state %>
                </td>
                <td class="meta-section no-border-right">
                    Invoice No: <span class="bold"><%= invoice_number %></span>
                </td>
                <td class="meta-section no-border-right">
                    Dated: <span class="bold"><%= invoice_date %></span>
                </td>
            </tr>
            <tr>
                <td class="no-border-right">Delivery Note: <%= delivery_note %></td>
                <td class="no-border-right">Mode/Terms of Payment</td>
            </tr>
            <tr>
                <td class="no-border-right">Supplier's Ref: <%= supplier_ref %></td>
                <td class="no-border-right">Other Reference(s)</td>
            </tr>
            <tr>
                <td class="no-border-right">Buyer's Order No.: <%= buyer_order_no %></td>
                <td class="no-border-right">Dated</td>
            </tr>
            <tr>
                <td class="no-border-left no-border-bottom"></td>
                <td class="no-border-right">Despatch Document No.: <%= despatch_doc_no %></td>
                <td class="no-border-right">Delivery Note Date</td>
            </tr>
            <tr>
                <td class="no-border-left no-border-top"></td>
                <td class="no-border-right">Despatch Through: <%= despatch_through %></td>
                <td class="no-border-right">Destination: <%= destination %></td>
            </tr>
            <tr>
                <td class="no-border-left no-border-bottom"></td>
                <td colspan="2" class="no-border-right">Terms of Delivery: <br><%= terms_of_delivery %></td>
            </tr>
        </table>

        <table class="items-table">
            <thead>
                <tr>
                    <th style="width: 5%;">Sl No.</th>
                    <th style="width: 40%;">Description of Goods</th>
                    <th style="width: 10%;">HSN/SAC</th>
                    <th style="width: 8%;">GST Rate</th>
                    <th style="width: 8%;">Quantity</th>
                    <th style="width: 10%;">Rate</th>
                    <th style="width: 5%;">per</th>
                    <th style="width: 5%;">Disc%</th>
                    <th style="width: 10%;">Amount</th>
                </tr>
            </thead>
            <tbody>
                <% (line_items || []).forEach(function(item) { %>
                <tr style="border-bottom: none;">
                    <td class="text-center"><%= item.sl_no %></td>
                    <td><%= item.description %></td>
                    <td class="text-center"><%= item.hsn_sac %></td>
                    <td class="text-center"><%= item.gst_rate %></td>
                    <td class="text-center"><%= item.quantity %></td>
                    <td class="text-right"><%= item.rate %></td>
                    <td class="text-center"><%= item.per %></td>
                    <td class="text-center"><%= item.disc_percent %></td>
                    <td class="text-right"><%= item.amount %></td>
                </tr>
                <% }); %>
                <!-- Empty spacing rows if needed to fill space -->
                <tr style="border-top: none; height: 100px;">
                    <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td>
                </tr>
                <tr>
                    <td></td>
                    <td class="text-right bold">SGST</td>
                    <td></td><td></td><td></td><td></td><td></td><td></td>
                    <td class="text-right"><%= sgst_amount %></td>
                </tr>
                <tr>
                    <td></td>
                    <td class="text-right bold">CGST</td>
                    <td></td><td></td><td></td><td></td><td></td><td></td>
                    <td class="text-right"><%= cgst_amount %></td>
                </tr>
                <tr>
                    <td></td>
                    <td class="text-right bold">Round Off</td>
                    <td></td><td></td><td></td><td></td><td></td><td></td>
                    <td class="text-right"><%= round_off %></td>
                </tr>
                <tr>
                    <td colspan="8" class="text-right bold">Total</td>
                    <td class="text-right bold"><%= total_amount %></td>
                </tr>
            </tbody>
        </table>

        <table>
            <tr>
                <td class="bold">Amount Chargeable(in words)</td>
                <td class="text-right" style="width: 50px; border-left: none;">E. & O.E</td>
            </tr>
            <tr>
                <td colspan="2" class="bold">Rs. <%= amount_in_words %></td>
            </tr>
        </table>

        <table class="hsn-table">
            <thead>
                <tr>
                    <th rowspan="2">HSN/SAC</th>
                    <th rowspan="2">Taxable Value</th>
                    <th colspan="2">Central Tax</th>
                    <th colspan="2">State Tax</th>
                    <th rowspan="2">Total Tax Amount</th>
                </tr>
                <tr>
                    <th>Rate</th>
                    <th>Amount</th>
                    <th>Rate</th>
                    <th>Amount</th>
                </tr>
            </thead>
            <tbody>
                <% (hsn_summary || []).forEach(function(row) { %>
                <tr>
                    <td class="text-center"><%= row.hsn_sac %></td>
                    <td class="text-right"><%= row.taxable_value %></td>
                    <td class="text-center"><%= row.cgst_rate %></td>
                    <td class="text-right"><%= row.cgst_amount %></td>
                    <td class="text-center"><%= row.sgst_rate %></td>
                    <td class="text-right"><%= row.sgst_amount %></td>
                    <td class="text-right"><%= row.total_tax %></td>
                </tr>
                <% }); %>
                <tr class="bold">
                    <td class="text-right">Total</td>
                    <td class="text-right"><%= (hsn_summary || []).reduce((acc, row) => acc + parseFloat(row.taxable_value || 0), 0).toFixed(2) %></td>
                    <td></td>
                    <td class="text-right"><%= (hsn_summary || []).reduce((acc, row) => acc + parseFloat(row.cgst_amount || 0), 0).toFixed(2) %></td>
                    <td></td>
                    <td class="text-right"><%= (hsn_summary || []).reduce((acc, row) => acc + parseFloat(row.sgst_amount || 0), 0).toFixed(2) %></td>
                    <td class="text-right"><%= (hsn_summary || []).reduce((acc, row) => acc + parseFloat(row.total_tax || 0), 0).toFixed(2) %></td>
                </tr>
            </tbody>
        </table>

        <table>
            <tr>
                <td class="bold">Tax Amount (in words): <%= tax_amount_in_words %></td>
            </tr>
        </table>

        <div class="footer-section">
            <div class="bank-details">
                <span class="bold">Company Bank Details :</span><br>
                Bank Name : Bank Of India<br>
                Branch & IFSC Code : TILJALA BKID0004046<br>
                A/c No. : 404620110000213
            </div>
            <div class="signatory-section">
                <span class="bold">For M.R. ELECTRICALS</span>
                <br><br><br>
                <span>Authorised Signatory</span>
            </div>
        </div>

        <div class="terms">
            (1)We are not responsible for any Brekage/Damage/Shaortage/Leakage in transit.<br>
            (2)Our responsibility ceases when the goods are delivered to the carrier.<br>
            (3)Goods once sold will not be accepted back.<br>
            (4)Interest @12% p.a. will be charged, if invoice is not paid on or before due date.<br>
            (5)Subject to Kolkata Jurisdiction.
        </div>
    </div>
</body>
</html>